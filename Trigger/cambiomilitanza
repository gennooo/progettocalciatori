//se si vuole modificare un valore di una militanza si deve controllare che quella militanza non sia finita
CREATE OR REPLACE FUNCTION militanza_finitaUpd()
RETURNS TRIGGER AS $$
BEGIN 
	IF ((SELECT data_termine
	    FROM Militanza
	    WHERE id_militanza = New.id_militanza) IS NOT NULL) THEN
		RAISE EXCEPTION 'Non si pu√≤ modificare militanza %. Terminata.', NEW.id_militanza;
	END IF;
	RETURN NEW;
END;
$$ Language plpgsql;


CREATE TRIGGER militanza_finita
BEFORE UPDATE OF partite_giocate, goal_segnati, goal_subiti, assist ON Militanza
FOR EACH ROW 
EXECUTE FUNCTION militanza_finitaUpd(); 
